<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>è¨ªå•ã‚±ã‚¢ãƒ»ã‚¯ã‚¨ã‚¹ãƒˆï½œæ–°äººãƒ˜ãƒ«ãƒ‘ãƒ¼ç·¨ï¼ˆç¬¬1ã€œ14ç« ï¼‰</title>
<style>
  :root{--bg:#f7f7fb;--card:#ffffff;--ink:#0f172a;--muted:#64748b;--accent:#2563eb;--good:#16a34a;--bad:#dc2626;}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans JP","Hiragino Kaku Gothic ProN","Yu Gothic",Arial,"Apple Color Emoji","Segoe UI Emoji","Noto Color Emoji",sans-serif}
  .wrap{max-width:980px;margin:0 auto;padding:18px}
  h1{margin:8px 0 0 0;font-size:22px}
  .sub{color:var(--muted);margin:4px 0 16px 0}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
  .card{background:var(--card);border-radius:14px;box-shadow:0 10px 24px rgba(0,0,0,.08);padding:14px;cursor:pointer;display:flex;flex-direction:column;gap:8px;border:1px solid #e5e7eb}
  .card:hover{transform:translateY(-1px);box-shadow:0 12px 26px rgba(0,0,0,.12)}
  .tag{display:inline-block;background:#eff6ff;color:#1d4ed8;border:1px solid #bfdbfe;border-radius:999px;padding:2px 8px;font-size:12px;margin-right:4px}
  .play{margin-top:auto;align-self:flex-end;background:#111827;color:#fff;border:0;border-radius:10px;padding:8px 12px;font-weight:700}
  .stage{background:var(--card);border-radius:16px;box-shadow:0 10px 28px rgba(0,0,0,.10);overflow:hidden;display:none;margin-top:6px}
  .scene{padding:14px;border-bottom:1px solid #eee}
  .row{display:flex;gap:10px;align-items:flex-start}
  .char{flex:1;background:#f3f4f6;border-radius:12px;padding:10px}
  .char h3{margin:0 0 6px 0;font-size:15px}
  .char .face{font-size:26px;line-height:1.2}
  .bubble{background:#eef2ff;border-left:4px solid var(--accent);padding:10px;border-radius:8px}
  .bubble p{margin:0;font-size:15px}
  .system{padding:10px 14px;background:#ecfeff;border-left:4px solid #06b6d4}
  .choices{display:grid;grid-template-columns:1fr;gap:8px;padding:12px}
  .choices button{appearance:none;border:0;border-radius:10px;padding:11px 12px;font-size:15px;font-weight:700;background:#111827;color:#fff;cursor:pointer}
  .choices button.secondary{background:#334155}
  .choices button.warn{background:#b91c1c}
  .choices button:hover{filter:brightness(1.05)}
  .result{padding:12px;display:none}
  .result.good{background:#ecfdf5;border-left:4px solid var(--good)}
  .result.bad{background:#fef2f2;border-left:4px solid var(--bad)}
  .footer{display:flex;gap:8px;justify-content:flex-end;padding:12px;border-top:1px solid #eee}
  .footer button{appearance:none;border:0;background:#2563eb;color:#fff;padding:10px 12px;border-radius:10px;font-weight:700}
  .footer button.alt{background:#475569}
  .meter{margin-top:8px;height:10px;background:#e5e7eb;border-radius:999px;overflow:hidden}
  .meter>div{height:100%;width:0%;background:linear-gradient(90deg,#22c55e,#16a34a);transition:width .5s}
  .badge{display:inline-block;background:#111827;color:#fff;border-radius:999px;padding:4px 10px;font-size:12px;margin-left:8px}
  .topbar{display:flex;gap:10px;align-items:center;justify-content:space-between}
  .back{appearance:none;border:0;background:#111827;color:#fff;border-radius:10px;padding:8px 12px;font-weight:700}
  .muted{color:var(--muted);font-size:13px}
</style>
</head>
<body>
<div class="wrap">
  <div class="topbar">
    <div>
      <h1>è¨ªå•ã‚±ã‚¢ãƒ»ã‚¯ã‚¨ã‚¹ãƒˆï½œæ–°äººãƒ˜ãƒ«ãƒ‘ãƒ¼ç·¨ï¼ˆç¬¬1ã€œ14ç« ï¼‰</h1>
      <p class="sub">ä¸»äººå…¬ï¼š<strong>ã“ã¨ã¯ã•ã‚“ï¼ˆæ–°äººãƒ˜ãƒ«ãƒ‘ãƒ¼ï¼‰</strong>ï¼ã“ã¨ã¯ã‚±ã‚¢ã‚µãƒ¼ãƒ“ã‚¹ï½œã‚»ãƒ¼ãƒ–ä¸è¦ãƒ»ã‚¹ãƒãƒ›OKï½œé¸æŠè‚¢ã§å­¦ã¶</p>
    </div>
    <button class="back" id="toMenu" style="display:none" onclick="toMenu()">ç« ä¸€è¦§ã¸</button>
  </div>

  <div id="menu"><div class="grid" id="cards"></div></div>

  <div class="stage" id="game">
    <div class="scene">
      <div class="row">
        <div class="char"><h3>ã“ã¨ã¯ã•ã‚“ï¼ˆæ–°äººãƒ˜ãƒ«ãƒ‘ãƒ¼ï¼‰</h3><div class="face" id="kotohaFace">ğŸ˜…</div><div class="muted">â€»ã‚„ã‚„ç·Šå¼µ</div></div>
        <div class="char"><h3>å¥ˆè‰¯å­ã•ã‚“</h3><div class="face" id="narakoFace">ğŸ™‚</div><div class="muted">â€»è¡¨æƒ…ãŒå¤‰ã‚ã‚Šã¾ã™</div></div>
        <div class="char"><h3>å¥ˆè‰¯ç”·ã•ã‚“</h3><div class="face" id="naraoFace">ğŸ•´ï¸</div><div class="muted">â€»å¿…è¦æ™‚ã«ç™»å ´</div></div>
      </div>
    </div>

    <div class="system"><span id="chapterTitle"></span> <span class="badge" id="badge">è¨­å•1/2</span></div>
    <div class="scene"><div class="bubble" id="dialogue"></div></div>
    <div class="choices" id="choices"></div>
    <div class="result" id="resultBox"></div>

    <div class="scene" id="summaryBox" style="display:none">
      <h3>ç« ã®ã¾ã¨ã‚</h3>
      <p id="summaryText"></p>
      <div class="meter"><div id="meterBar"></div></div>
    </div>

    <div class="footer">
      <button class="alt" onclick="restart()">ã“ã®ç« ã‚’ã‚„ã‚Šç›´ã™</button>
      <button id="nextBtn" onclick="next()">æ¬¡ã¸</button>
    </div>
  </div>
</div>

<script>
// ====== ã‚·ãƒŠãƒªã‚ªå®šç¾©ï¼ˆ1ã€œ14ç« ï¼‹4.5ç« ï¼‰ ======
const chapters = [
  { id:'1', title:'ç¬¬1ç« ï¼šåˆå›è¨ªå•ã®æŒ¨æ‹¶', q:[
    { text:'ã“ã¨ã¯ï¼šã€Œæœ¬æ—¥ã‹ã‚‰æ‹…å½“ã„ãŸã—ã¾ã™ã€ã“ã¨ã¯ã§ã™ã€‚ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ï¼ã€<br/>å¥ˆè‰¯å­ï¼šã€Œè‹¥ã„ã®ã­ã‡ã€‚ã¡ã‚ƒã‚“ã¨ã§ãã‚‹ï¼Ÿã€',
      opts:[ ['å…ƒæ°—ã‚ˆãä»»ã›ã¦ãã ã•ã„ï¼',+15,'good','è‡ªä¿¡ã‚’ç¤ºã—ã¤ã¤ä¸å¯§ã€‚'],
             ['æ­£ç›´ã«å‹‰å¼·ä¸­ã§ã™ãŒé ‘å¼µã‚Šã¾ã™',+10,'good','ç­‰èº«å¤§ã®å§¿å‹¢ãŒå®‰å¿ƒæ„Ÿã«ã€‚'],
             ['ç„¡è¨€ã§ä½œæ¥­ã‚’å§‹ã‚ã‚‹',-15,'bad','é»™ã£ã¦å§‹ã‚ã‚‹ã®ã¯NGã€‚'] ]},
    { text:'å¥ˆè‰¯å­ï¼šã€Œæ´—æ¿¯ç‰©ã¯è§¦ã‚‰ã‚“ã¨ã„ã¦ã€‚ã€ã©ã†è¿”ã™ï¼Ÿ',
      opts:[ ['ç†ç”±ã‚’ä¸å¯§ã«ä¼ºã†',+20,'good','ä¸å®‰ã®è¨€èªåŒ–â†’å…±æœ‰ã€‚è¦³å¯ŸåŠ›ï¼‹1'],
             ['ã„ã£ãŸã‚“æ§˜å­è¦‹ã‚’ææ¡ˆ',+5,'neutral','æ¬¡ã®å£°ã‹ã‘ãŒéµã€‚'],
             ['æ™‚é–“ãŒãªã„ã®ã§ã‚„ã‚Šã¾ã™ã¨å¼·è¡Œ',-20,'bad','å¥ˆè‰¯ç”·ã•ã‚“ãŒåç™ºã€‚'] ]}
  ]},
  { id:'2', title:'ç¬¬2ç« ï¼šè¡›ç”Ÿç®¡ç†ï¼ˆæ‰‹æ´—ã„ãƒ»æ¶ˆæ¯’ï¼‰', q:[
    { text:'è¨ªå•ç›´å¾Œã®æ‰‹æŒ‡è¡›ç”Ÿã€æœ€é©ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¯ï¼Ÿ',
      opts:[ ['å…¥å®¤å‰ã¨å…¥å®¤ç›´å¾Œã®2å›',+15,'good','æ¥è§¦å‰ã«ç¢ºå®Ÿã«ã€‚'],
             ['ä½œæ¥­å¾Œã«ã¾ã¨ã‚ã¦1å›',-10,'bad','å‰å‡¦ç½®ãŒæŠœã‘ã‚‹ã€‚'],
             ['å…¨ãä¸è¦',-20,'bad','æ„ŸæŸ“ãƒªã‚¹ã‚¯ä¸Šæ˜‡ã€‚'] ]},
    { text:'ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«æ¶ˆæ¯’ãŒä½¿ãˆãªã„å ´åˆã¯ï¼Ÿ',
      opts:[ ['æµæ°´ã¨çŸ³é¹¸ã§20ç§’ä»¥ä¸Š',+15,'good','åŸºæœ¬ã‚’å¾¹åº•ã€‚'],
             ['æ¿¡ã‚Œã‚¿ã‚ªãƒ«ã§æ‹­ãã ã‘',-10,'bad','ä¸ååˆ†ã€‚'],
             ['æ¶ˆæ¯’ã¯çœç•¥',-20,'bad','NGã€‚'] ]}
  ]},
  { id:'3', title:'ç¬¬3ç« ï¼šæœè–¬ç¢ºèª', q:[
    { text:'æœã®æœè–¬ã€ç¢ºèªã®ç¬¬ä¸€å£°ã¯ï¼Ÿ',
      opts:[ ['ã€Œã„ã¤ã‚‚é€šã‚Šé£²ã‚ã¦ã„ã¾ã™ã‹ï¼Ÿã€',+10,'good','æœ¬äººç¢ºèªã‹ã‚‰ã€‚'],
             ['ã€Œè–¬ã¯ã©ã“ï¼Ÿã€ã ã‘èã',-5,'neutral','è³ªå•ãŒæ›–æ˜§ã€‚'],
             ['è¢‹ã‚’é–‹ã‘ã¦å‹æ‰‹ã«æ¸¡ã™',-15,'bad','äº‹æ•…ãƒªã‚¹ã‚¯ã€‚'] ]},
    { text:'æ®‹è–¬ãŒå¤šã„ã¨åˆ¤æ˜ã€‚ã©ã†ã™ã‚‹ï¼Ÿ',
      opts:[ ['ã‚±ã‚¢ãƒãƒãƒ»å®¶æ—ã¸å ±å‘Šã—è¨˜éŒ²',+15,'good','é€£æºãƒ»è¨˜éŒ²ãŒåŸºæœ¬ã€‚'],
             ['ä»Šæ—¥åˆ†ã‚’ã¾ã¨ã‚ã¦é£²ã¾ã›ã‚‹',-20,'bad','å±é™ºã€‚'],
             ['è¦‹ãªã‹ã£ãŸã“ã¨ã«ã™ã‚‹',-15,'bad','ãƒªã‚¹ã‚¯éš ã—ã€‚'] ]}
  ]},
  { id:'4', title:'ç¬¬4ç« ï¼šé£Ÿäº‹ä»‹åŠ©', q:[
    { text:'é£Ÿäº‹å‰ã®è¦³å¯Ÿãƒã‚¤ãƒ³ãƒˆã¯ï¼Ÿ',
      opts:[ ['å§¿å‹¢ãƒ»åš¥ä¸‹ãƒ»æ„è­˜ãƒ»ç¾©æ­¯',+15,'good','å®‰å…¨ç¬¬ä¸€ã€‚'],
             ['ãƒ†ãƒ¼ãƒ–ãƒ«ã®è‰²ã ã‘ç¢ºèª',-10,'bad','æœ¬è³ªã§ãªã„ã€‚'],
             ['ç¢ºèªã›ãšé–‹å§‹',-20,'bad','èª¤åš¥ãƒªã‚¹ã‚¯ã€‚'] ]},
    { text:'ã‚€ã›è¾¼ã¿ãŒå¢—ãˆãŸã€‚å¯¾å¿œã¯ï¼Ÿ',
      opts:[ ['ä¸€æ—¦ä¸­æ­¢ã—å§¿å‹¢ã¨æ°´åˆ†ã§èª¿æ•´',+15,'good','å®‰å…¨é…æ…®ã€‚'],
             ['æ€¥ã„ã§é£Ÿã¹ã•ã›ã‚‹',-20,'bad','äº‹æ•…ã«ç›´çµã€‚'],
             ['æ”¾ç½®ã™ã‚‹',-20,'bad','å±é™ºã€‚'] ]}
  ]},
  { id:'4.5', title:'ç¬¬4.5ç« ï¼šä»‹è­·ä¿é™ºå¤–ã®ä¾é ¼ï¼ˆå¥ˆè‰¯ç”·ã•ã‚“ï¼‰', q:[
    { text:'å¥ˆè‰¯ç”·ï¼šã€Œã¤ã„ã§ã«åº­ã®è‰ã‚€ã—ã‚Šã¨è»Šã®æ´—è»Šã‚‚ãŠé¡˜ã„ã§ãã¾ã™ï¼Ÿã€',
      opts:[ ['ã¯ã„ã€ã‚„ã‚Šã¾ã™ï¼ï¼ˆãã®ã¾ã¾å—ã‘ã‚‹ï¼‰',-20,'bad','ä¸æ­£ã‚µãƒ¼ãƒ“ã‚¹ã€‚ä¿¡é ¼ä½ä¸‹ã€‚'],
             ['ä¿é™ºã§ã¯ä¸å¯ã€‚è‡ªè²»ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã”æ¡ˆå†…',+20,'good','æ­£è§£ã€‚ä»£æ›¿ææ¡ˆãŒâ—ã€‚'],
             ['å¿™ã—ã„ã®ã§ç„¡ç†ã€ã¨ã ã‘æ–­ã‚‹',-10,'neutral','è¨€ã„æ–¹ã®é…æ…®ä¸è¶³ã€‚'] ]},
    { text:'ã•ã‚‰ã«ã€Œé€šå¸³ã®å¼•ãå‡ºã—ã‚‚â€¦ã€ã¨è¨€ã‚ã‚ŒãŸå ´åˆã¯ï¼Ÿ',
      opts:[ ['ç¬¬ä¸‰è€…ã®é‡‘éŠ­ç®¡ç†ã¯ä¸å¯ã¨èª¬æ˜ï¼‹è¨˜éŒ²',+20,'good','ãƒ«ãƒ¼ãƒ«éµå®ˆã¨è¨˜éŒ²ã€‚'],
             ['å†…ç·’ã§å°‘é¡ãªã‚‰å¯¾å¿œ',-20,'bad','ã‚³ãƒ³ãƒ—ãƒ©é•åã€‚'],
             ['é»™ã£ã¦ã‚¹ãƒ«ãƒ¼',-10,'bad','æ›–æ˜§å¯¾å¿œã¯ç«ç¨®ã€‚'] ]}
  ]},
  { id:'5', title:'ç¬¬5ç« ï¼šç§»å‹•ãƒ»ç§»ä¹—ä»‹åŠ©', q:[
    { text:'ç«‹ä½ãŒä¸å®‰å®šã€‚æœ€åˆã«ç¢ºèªã™ã‚‹ã®ã¯ï¼Ÿ',
      opts:[ ['è¶³å…ƒãƒ»ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ»ä½“èª¿',+15,'good','åŸºæœ¬ã®3ç‚¹ã€‚'],
             ['æ°—åˆã„',-10,'bad','æ ¹æ€§è«–NGã€‚'],
             ['å®¶å…·ã‚’å¼•ã£å¼µã‚‹',-15,'bad','è»¢å€’ãƒªã‚¹ã‚¯ã€‚'] ]},
    { text:'ãƒ™ãƒƒãƒ‰â†’è»Šæ¤…å­ã®ç§»ä¹—ã€å£°ã‹ã‘ã¯ï¼Ÿ',
      opts:[ ['ã€Œ1,2,3ã§ç«‹ã¡ã¾ã™ã€ç­‰ã®äºˆå‘Š',+15,'good','åˆå›³ã§åŒæœŸã€‚'],
             ['ç„¡è¨€ã§æŒã¡ä¸Šã’ã‚‹',-15,'bad','ææ€–ï¼†æ€ªæˆ‘ã®å…ƒã€‚'],
             ['è…°ã‚’å¼•ã£å¼µã‚‹',-10,'bad','è…°ç—›ãƒªã‚¹ã‚¯ã€‚'] ]}
  ]},
  { id:'6', title:'ç¬¬6ç« ï¼šæ¸…æƒãƒ»ç”Ÿæ´»æ´åŠ©', q:[
    { text:'æƒé™¤ã®å„ªå…ˆé †ä½ã¯ï¼Ÿ',
      opts:[ ['å‹•ç·šãƒ»æ°´å›ã‚Šãƒ»è¡›ç”Ÿæœ€å„ªå…ˆ',+15,'good','å®‰å…¨é‡è¦–ã€‚'],
             ['è¦‹æ „ãˆé‡è¦–',-10,'bad','æœ¬æœ«è»¢å€’ã€‚'],
             ['åˆ©ç”¨è€…ã®äº†æ‰¿ãªãæ¨¡æ§˜æ›¿ãˆ',-15,'bad','åŒæ„ãŒå¿…è¦ã€‚'] ]},
    { text:'æ´—æ¿¯ã§è‰²ç§»ã‚Šãƒªã‚¹ã‚¯ã€‚ã©ã†ã™ã‚‹ï¼Ÿ',
      opts:[ ['åˆ†åˆ¥ï¼‹ç¢ºèªã—ã¦é€²ã‚ã‚‹',+15,'good','èª¬æ˜ã¨åŒæ„ã€‚'],
             ['ã¾ã¨ã‚ã¦æ´—ã†',-15,'bad','äº‹æ•…ã®å…ƒã€‚'],
             ['æ”¾ç½®',-10,'bad','å®¶äº‹æ”¾æ£„ã€‚'] ]}
  ]},
  { id:'7', title:'ç¬¬7ç« ï¼šæ’æ³„ä»‹åŠ©', q:[
    { text:'ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼é…æ…®ã§é‡è¦ãªã®ã¯ï¼Ÿ',
      opts:[ ['å£°ã‹ã‘ãƒ»ã‚«ãƒ¼ãƒ†ãƒ³ãƒ»åŒæ„',+15,'good','å°Šå³ã‚’å®ˆã‚‹ã€‚'],
             ['æ—©ã•é‡è¦–',-10,'bad','å°Šå³è»½è¦–ã€‚'],
             ['ç„¡è¨€ã§å®Ÿæ–½',-15,'bad','ä¸å®‰ãŒå¢—ãˆã‚‹ã€‚'] ]},
    { text:'ç•°å¸¸å°¿ã‚’ç™ºè¦‹ã€‚å¯¾å¿œã¯ï¼Ÿ',
      opts:[ ['è¦³å¯Ÿè¨˜éŒ²â†’å ±é€£ç›¸',+15,'good','è¿…é€Ÿé€£æºã€‚'],
             ['æ§˜å­è¦‹ã§æ”¾ç½®',-15,'bad','æ‚ªåŒ–ãƒªã‚¹ã‚¯ã€‚'],
             ['å†™çœŸã ã‘æ’®ã‚‹',-10,'bad','æ©Ÿå¯†ãƒ»åŒæ„ã«é…æ…®ä¸è¶³ã€‚'] ]}
  ]},
  { id:'8', title:'ç¬¬8ç« ï¼šèªçŸ¥ç—‡ã®æ–¹ã¨ã®ä¼šè©±', q:[
    { text:'ã€Œå®¶ã«å¸°ã‚‹ã€ã¨ä¸å®‰ãªæ§˜å­ã€‚ã©ã†å£°ã‹ã‘ï¼Ÿ',
      opts:[ ['æ°—æŒã¡ã‚’å—ã‘æ­¢ã‚å®‰å¿ƒã‚’æä¾›',+15,'good','å…±æ„ŸãŒåŸºæœ¬ã€‚'],
             ['ç¾å®Ÿã‚’çªãã¤ã‘ã‚‹',-10,'bad','å¯¾ç«‹ã«ã€‚'],
             ['ç„¡è¦–ã™ã‚‹',-15,'bad','ä¸å®‰å¢—å¤§ã€‚'] ]},
    { text:'åŒã˜è³ªå•ã‚’ç¹°ã‚Šè¿”ã™ã€‚å¯¾å¿œã¯ï¼Ÿ',
      opts:[ ['çŸ­ãå„ªã—ãç¹°ã‚Šè¿”ã—å›ç­”',+10,'good','å®‰å¿ƒã®ç¶™ç¶šã€‚'],
             ['ã‚¤ãƒ©ã¤ãã‚’è¦‹ã›ã‚‹',-15,'bad','ä¸ä¿¡ã«ã€‚'],
             ['åˆ¥ã®è©±é¡Œã¸æŸ”ã‚‰ã‹ãè»¢æ›',+10,'good','ä¸å®‰ã®åˆ†æ•£ã€‚'] ]}
  ]},
  { id:'9', title:'ç¬¬9ç« ï¼šç·Šæ€¥å¯¾å¿œï¼ˆè»¢å€’ãƒ»ä½“èª¿æ€¥å¤‰ï¼‰', q:[
    { text:'è»¢å€’ç™ºè¦‹ã€‚æœ€åˆã®è¡Œå‹•ã¯ï¼Ÿ',
      opts:[ ['æ„è­˜ãƒ»å‘¼å¸ãƒ»å‡ºè¡€ã‚’ç¢ºèª',+20,'good','ä¸€æ¬¡è©•ä¾¡ã€‚'],
             ['ã™ãèµ·ã“ã™',-15,'bad','äºŒæ¬¡è¢«å®³ã€‚'],
             ['å±ã‚‹',-20,'bad','è«–å¤–ã€‚'] ]},
    { text:'æ€¥å¤‰æ™‚ã€é€£çµ¡å…ˆã®å„ªå…ˆã¯ï¼Ÿ',
      opts:[ ['æ•‘æ€¥â†’å®¶æ—â†’äº‹æ¥­æ‰€â†’è¨˜éŒ²',+20,'good','å‘½å„ªå…ˆã€‚'],
             ['å®¶æ—ã ã‘',-10,'bad','æ‰‹é †ä¸è¶³ã€‚'],
             ['è¨˜éŒ²ã ã‘',-20,'bad','é…å»¶ã€‚'] ]}
  ]},
  { id:'10', title:'ç¬¬10ç« ï¼šè¨˜éŒ²ã¨å ±å‘Š', q:[
    { text:'è¨˜éŒ²ã®åŸå‰‡ã¯ï¼Ÿ',
      opts:[ ['äº‹å®Ÿãƒ»æ™‚é–“ãƒ»èª°ãŒãƒ»ä½•ã‚’',+15,'good','5W1Hã®æ ¸ã€‚'],
             ['æ„Ÿæƒ³ãƒ¡ã‚¤ãƒ³',-10,'bad','ä¸»è¦³éå¤šã€‚'],
             ['å¾Œã§ã¾ã¨ã‚ã¦æƒ³åƒã§',-20,'bad','æ”¹ã–ã‚“ãƒªã‚¹ã‚¯ã€‚'] ]},
    { text:'ãƒ’ãƒ¤ãƒªç™ºç”Ÿã€‚å¯¾å¿œã¯ï¼Ÿ',
      opts:[ ['ä¸Šé•·ãƒ»ã‚±ã‚¢ãƒãƒã¸å ±å‘Šã—æ˜¯æ­£',+15,'good','å­¦ã³ã«ã€‚'],
             ['éš ã™',-20,'bad','å†ç™ºå¿…è‡³ã€‚'],
             ['åŒåƒšã«ã ã‘æ„šç—´ã‚‹',-10,'bad','æ‹¡æ•£ãƒªã‚¹ã‚¯ã€‚'] ]}
  ]},
  { id:'11', title:'ç¬¬11ç« ï¼šè²·ã„ç‰©ã‚’ä¸€ç·’ã«è¡Œã†ï¼ˆå…±ã«è¡Œã†ä»‹è­·ï¼‰', q:[
    { text:'è²·ã„ç‰©ã®å‰ã«ç¢ºèªã™ã‚‹ã“ã¨ã¯ï¼Ÿ',
      opts:[ ['ä½“èª¿ãƒ»è²¡å¸ƒãƒ»è¡Œå…ˆãƒ»æ™‚é–“',+15,'good','æº–å‚™ãŒè‡ªç«‹ã‚’æ”¯ãˆã‚‹ã€‚'],
             ['è‡ªåˆ†ã®å¥½ã¿ã§æ±ºã‚ã‚‹',-10,'bad','æœ¬äººä¸»ä½“ã§ã€‚'],
             ['ãƒãƒ¼ãƒ—ãƒ©ãƒ³ã§å‡ºç™º',-10,'bad','æ··ä¹±ã«ã€‚'] ]},
    { text:'ãƒ¬ã‚¸ã§æ··ä¹±ã€‚ã©ã†æ”¯ãˆã‚‹ï¼Ÿ',
      opts:[ ['å°é¡ã‹ã‚‰ãƒ»ã‚†ã£ãã‚Šä¿ƒã™',+10,'good','æˆåŠŸä½“é¨“ã‚’å®ˆã‚‹ã€‚'],
             ['ä»£ã‚ã‚Šã«å…¨éƒ¨æ‰•ã†',-10,'bad','è‡ªç«‹ã‚’å¥ªã†ã€‚'],
             ['å±è²¬ã™ã‚‹',-15,'bad','é–¢ä¿‚æ‚ªåŒ–ã€‚'] ]}
  ]},
  { id:'12', title:'ç¬¬12ç« ï¼šæ´—æ¿¯ç‰©ã‚’ä¸€ç·’ã«å¹²ã™ï¼ˆå…±ã«è¡Œã†ä»‹è­·ï¼‰', q:[
    { text:'å½¹å‰²åˆ†æ‹…ã¯ï¼Ÿ',
      opts:[ ['é«˜æ‰€ã¯ãƒ˜ãƒ«ãƒ‘ãƒ¼ã€ä½ã„ä½ç½®ã¯æœ¬äºº',+15,'good','å®‰å…¨ï¼‹è‡ªç«‹ã€‚'],
             ['å…¨éƒ¨ãƒ˜ãƒ«ãƒ‘ãƒ¼ãŒã‚„ã‚‹',-10,'bad','æ©Ÿä¼šå–ªå¤±ã€‚'],
             ['å…¨éƒ¨æœ¬äººã«ä»»ã›ã‚‹',-10,'bad','å±é™ºã€‚'] ]},
    { text:'ç–²åŠ´ã‚µã‚¤ãƒ³ã€‚å¯¾å¿œã¯ï¼Ÿ',
      opts:[ ['ã„ã£ãŸã‚“ä¼‘æ†©ãƒ»åº§ä½ã§ç¶šè¡Œ',+15,'good','ç„¡ç†ãªãã€‚'],
             ['ãã®ã¾ã¾ç¶šã‘ã‚‹',-10,'bad','è»¢å€’ãƒªã‚¹ã‚¯ã€‚'],
             ['ä½œæ¥­çµ‚äº†ã‚’å¼·è¦',-10,'bad','ä¸ä¿¡æ„Ÿã€‚'] ]}
  ]},
  { id:'13', title:'ç¬¬13ç« ï¼šæ–™ç†ã‚’ä¸€ç·’ã«ä½œã‚‹ï¼ˆå…±ã«è¡Œã†ä»‹è­·ï¼‰', q:[
    { text:'åŒ…ä¸ä½¿ç”¨æ™‚ã®å·¥å¤«ã¯ï¼Ÿ',
      opts:[ ['æ»‘ã‚Šæ­¢ã‚ãƒ»è¦‹å®ˆã‚Šãƒ»å£°ã‹ã‘',+15,'good','å®‰å…¨ç¬¬ä¸€ã€‚'],
             ['é›¢å¸­ã—ã¦ä»»ã›ã‚‹',-15,'bad','å±é™ºã€‚'],
             ['æ¡åŠ›ãƒ†ã‚¹ãƒˆã®ã¿',-5,'neutral','ä¸ååˆ†ã€‚'] ]},
    { text:'å‘³ä»˜ã‘ã®ã“ã ã‚ã‚Šã€‚å¯¾å¿œã¯ï¼Ÿ',
      opts:[ ['æœ¬äººã®å—œå¥½ã‚’å°Šé‡',+10,'good','æº€è¶³åº¦UPã€‚'],
             ['è‡ªåˆ†ã®å‘³ã«ã™ã‚‹',-10,'bad','ä¸æº€ã«ã€‚'],
             ['å¡©åˆ†éå¤šã‚’æ¨å¥¨',-15,'bad','å¥åº·è¢«å®³ã€‚'] ]}
  ]},
  { id:'14', title:'ç¬¬14ç« ï¼šæƒé™¤ã‚’ä¸€ç·’ã«ã™ã‚‹ï¼ˆå…±ã«è¡Œã†ä»‹è­·ï¼‰', q:[
    { text:'æƒé™¤ç¯„å›²ã®åˆæ„ã¯ï¼Ÿ',
      opts:[ ['å„ªå…ˆé †ä½ã‚’ä¸€ç·’ã«æ±ºã‚ã‚‹',+15,'good','æœ¬äººä¸»ä½“ã€‚'],
             ['å‹æ‰‹ã«å…¨å…¥ã‚Œæ›¿ãˆ',-15,'bad','æ··ä¹±ã€‚'],
             ['ä½•ã‚‚æ±ºã‚ãªã„',-10,'bad','éåŠ¹ç‡ã€‚'] ]},
    { text:'é‡ã„å®¶å…·ç§»å‹•ã‚’å¸Œæœ›ã€‚å¯¾å¿œã¯ï¼Ÿ',
      opts:[ ['å®‰å…¨ç¬¬ä¸€ã§åˆ¥æ¡ˆæç¤º',+15,'good','ä»£æ›¿ç­–ã€‚'],
             ['ä¸€äººã§å¼·è¡Œ',-15,'bad','æ€ªæˆ‘ãƒªã‚¹ã‚¯ã€‚'],
             ['æ€’ã£ã¦æ–­ã‚‹',-10,'bad','é–¢ä¿‚æ‚ªåŒ–ã€‚'] ]}
  ]},
];

// ====== ã‚²ãƒ¼ãƒ çŠ¶æ…‹ ======
let trust = 0, qIndex = 0, currentChapter = null;

// ====== è¦ç´  ======
const menu = document.getElementById('menu');
const cards = document.getElementById('cards');
const game = document.getElementById('game');
const badge = document.getElementById('badge');
const chapTitle = document.getElementById('chapterTitle');
const dialogue = document.getElementById('dialogue');
const choices = document.getElementById('choices');
const resultBox = document.getElementById('resultBox');
const kFace = document.getElementById('kotohaFace');
const nFace = document.getElementById('narakoFace');
const oFace = document.getElementById('naraoFace');
const nextBtn = document.getElementById('nextBtn');
const toMenuBtn = document.getElementById('toMenu');
const summaryBox = document.getElementById('summaryBox');
const summaryText = document.getElementById('summaryText');
const meterBar = document.getElementById('meterBar');

// ====== ãƒ¡ãƒ‹ãƒ¥ãƒ¼æç”» ======
function buildMenu(){
  cards.innerHTML = '';
  chapters.forEach((ch)=>{
    const c = document.createElement('div');
    c.className = 'card';
    const tags = document.createElement('div');
    const t2 = document.createElement('span'); t2.className='tag'; t2.textContent = (parseFloat(ch.id)<=10?'æ–°äººãƒ˜ãƒ«ãƒ‘ãƒ¼':'å…±ã«è¡Œã†ä»‹è­·');
    tags.appendChild(t2);
    const h = document.createElement('div'); h.innerHTML = `<strong>${ch.title}</strong>`;
    const s = document.createElement('div'); s.className='muted'; s.textContent = `è¨­å• ${ch.q.length} å•ï¼ã‚¯ãƒªãƒƒã‚¯ã§é–‹å§‹`;
    const b = document.createElement('button'); b.className='play'; b.textContent='ã“ã®ç« ã§éŠã¶'; b.onclick = ()=>startChapter(ch);
    c.appendChild(tags); c.appendChild(h); c.appendChild(s); c.appendChild(b);
    cards.appendChild(c);
  });
}
buildMenu();

// ====== ç« é–‹å§‹ ======
function startChapter(ch){
  currentChapter = ch;
  trust = 0; qIndex = 0;
  kFace.textContent = 'ğŸ˜…'; nFace.textContent='ğŸ™‚'; oFace.textContent='ğŸ•´ï¸';
  chapTitle.textContent = ch.title;
  menu.style.display='none'; game.style.display='block'; toMenuBtn.style.display='inline-block';
  summaryBox.style.display='none'; resultBox.style.display='none'; nextBtn.style.display='none';
  renderQuestion();
}

// ====== è¨­å•æç”» ======
function renderQuestion(){
  const q = currentChapter.q[qIndex];
  badge.textContent = `è¨­å•${qIndex+1}/${currentChapter.q.length}`;
  dialogue.innerHTML = q.text;
  choices.innerHTML = '';
  resultBox.style.display='none';
  q.opts.forEach((op,i)=>{
    const b = document.createElement('button');
    b.textContent = (i===0?'1ï¸âƒ£ ':'')+(i===1?'2ï¸âƒ£ ':'')+(i===2?'3ï¸âƒ£ ':'') + op[0];
    if(i===1) b.classList.add('secondary');
    if(i===2) b.classList.add('warn');
    b.onclick = ()=>{
      trust += op[1];
      const kind = op[2], msg=op[3];
      if(kind==='good'){ nFace.textContent='ğŸ˜Š'; resultBox.className='result good'; }
      else if(kind==='bad'){ nFace.textContent='ğŸ˜ '; oFace.textContent='ğŸ˜¡'; resultBox.className='result bad'; }
      else { nFace.textContent='ğŸ˜•'; resultBox.className='result'; }
      resultBox.innerHTML = `<strong>çµæœï¼š</strong>${msg}ï¼ˆä¿¡é ¼ ${trust>=0?'+':''}${op[1]}ï¼‰`;
      resultBox.style.display='block';
      Array.from(choices.querySelectorAll('button')).forEach(x=>x.disabled=true);
      nextBtn.style.display='inline-block';
    };
    choices.appendChild(b);
  });
}

// ====== æ¬¡ã¸ï¼çµ‚äº† ======
function next(){
  qIndex++;
  if(qIndex >= currentChapter.q.length){ finishChapter(); }
  else { resultBox.style.display='none'; nextBtn.style.display='none'; renderQuestion(); }
}

function finishChapter(){
  const max = currentChapter.q.length*20;
  const pct = Math.max(0, Math.min(100, (trust/max)*100));
  const grade = pct>=80?'Sï¼ˆã¨ã¦ã‚‚è‰¯ã„ï¼‰':pct>=60?'Aï¼ˆè‰¯ã„ï¼‰':pct>=40?'Bï¼ˆãµã¤ã†ï¼‰':'Cï¼ˆè¦‹ç›´ã—ï¼‰';
  summaryText.innerHTML = `æœ€çµ‚è©•ä¾¡ï¼š<strong>${grade}</strong><br/>ç²å¾—ã‚¹ã‚³ã‚¢ï¼šä¿¡é ¼ ${trust} / ${max}<br/>å­¦ã³ï¼š<ul><li>æœ¬äººã®æ„æ€ã‚’å°Šé‡ã—ç†ç”±ã‚’è´ã</li><li>å®‰å…¨ã¨æ‰‹é †ã‚’å…±æœ‰</li><li>å®¶æ—ä»»ã›ãƒ»å¼·è¡Œã¯é¿ã‘ã€ä»£æ›¿ææ¡ˆ</li></ul>`;
  meterBar.style.width = pct + '%';
  summaryBox.style.display='block';
  nextBtn.style.display='none';
  choices.innerHTML='';
}

function restart(){
  trust = 0; qIndex = 0;
  kFace.textContent = 'ğŸ˜…'; nFace.textContent='ğŸ™‚'; oFace.textContent='ğŸ•´ï¸';
  summaryBox.style.display='none'; resultBox.style.display='none'; nextBtn.style.display='none';
  renderQuestion();
}

function toMenu(){
  game.style.display='none'; menu.style.display='block'; toMenuBtn.style.display='none';
}
</script>
</body>
</html>
